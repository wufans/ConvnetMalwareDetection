from keras.models import Model
from keras.layers import Dense, Embedding, Conv1D, multiply, GlobalMaxPool1D, Input, Activation, GlobalAveragePooling1D, MaxPooling1D, AveragePooling1D

def Convnet(max_len, win_size=0, vocab_size=256):
    inp = Input((max_len,))
    emb = Embedding(vocab_size, 8)(inp)

    conv1 = Conv1D(kernel_size=(32), filters=48, strides=(4), padding='same')(emb)
    conv2 = Conv1D(kernel_size=(32), filters=96, strides=(4), padding='same')(conv1)

    maxpool1 = MaxPooling1D(4)(conv2)
    conv3 = Conv1D(kernel_size=(16), filters=128, strides=(8), padding='same')(maxpool1)
    conv4 = Conv1D(kernel_size=(16), filters=192, strides=(8), padding='same')(conv3)

    avepool = GlobalAveragePooling1D()(conv4)

    den1 = Dense(192)(avepool)
    den2 = Dense(160)(den1)
    den3 = Dense(128)(den2)


    out = Dense(1, activation='sigmoid')(den3)



    return Model(inp, out)
